!function(e){"use strict";e.fn.extend({extm:function(t){var i={zoomElement:!1,imageSrc:e(this).attr("src"),squareOverlay:!1,position:!1,rightPad:0,lazy:!1,zoomLevel:1,zoomSize:!1,loadingText:!1,loadingImage:!1},o=e.extend({},i,t||{});function s(t,i){var o,s,n,a=i.width(),l=i.height(),r=i.offset();if(t.zoomElement?o=t.zoomElement:(o=e("<div style='overflow:hidden;pointer-events:none;height:"+l+"px;width:"+a+"px;' class='extm'></div>"),"right"===t.position?(o.appendTo(e("body")),o.css("position","absolute"),o.css("top",r.top),o.css("left",r.left+a+t.rightPad)):"overlay"===t.position?(o.appendTo(e("body")),o.css("position","absolute"),o.css("top",r.top),o.css("left",r.left)):o.insertAfter(i)),t.squareOverlay&&(s=e("<div class='overlayElement' style='pointer-events:none;height:"+l+"px;width:"+a+"px;position:absolute;top:"+r.top+"px;left:"+r.left+"px;'></div>"),e("body").append(s),n=e("<div style='background-color:rgba(0,0,0,0.2);position:absolute;' class='innerOverlay'></div>"),s.append(n)),t.lazy||(o.css("visibility","hidden"),t.squareOverlay&&n.css("visibility","hidden")),t.zoomSize)var d=e('<img style="position:relative;max-width:none;width:'+t.zoomSize+'px;">');else if(1!==t.zoomLevel)d=e('<img style="position:relative;max-width:none;width:'+100*t.zoomLevel+'%;">');else d=e('<img style="position:relative;max-width:none;">');t.imageSrc?d.attr("src",t.imageSrc):d.attr("src",i.attr("src")),d.appendTo(o),function(t,i,o,s,n,a,l,r,d){if(d.loadingText){var h=e("<div class='loadingElement' style='pointer-events:none;height:"+n+"px;width:"+a+"px;font-family:sans-serif;position:absolute;top:"+l.top+"px;left:"+l.left+"px;visibility:hidden;background:rgba(255,255,255,0.5);color:black;font-size:2em;font-weight:bold;text-align:center;'><p style='position: absolute; left: 50%;top: 50%;transform: translate(-50%, -50%);'>"+d.loadingText+"</p></div>");e("body").append(h),t.on("mouseenter",(function(){h.css("visibility","visible")})),t.on("mouseleave",(function(){h.css("visibility","hidden")})),t.is(":hover")&&t.trigger("mouseenter")}else if(d.loadingImage){h=e("<div class='loadingElement' style='pointer-events:none;height:"+n+"px;width:"+a+"px;font-family:sans-serif;position:absolute;top:"+l.top+"px;left:"+l.left+"px;visibility:hidden;background:rgba(255,255,255,0.5);color:black;font-size:2em;font-weight:bold;text-align:center;'><img style='position: absolute; left: 50%;top: 50%;transform: translate(-50%, -50%);' src='"+d.loadingImage+"'/></div>");e("body").append(h),t.on("mouseenter",(function(){h.css("visibility","visible")})),t.on("mouseleave",(function(){h.css("visibility","hidden")})),t.is(":hover")&&t.trigger("mouseenter")}o.on("load",(function(){(d.loadingText||d.loadingImage)&&(t.trigger("mouseleave"),t.unbind("mouseenter mouseleave"),h.remove()),t.on("mouseenter",(function(){l=t.offset(),"right"===d.position?(i.css("top",l.top),i.css("left",l.left+a+d.rightPad)):"overlay"===d.position&&(i.css("top",l.top),i.css("left",l.left)),d.squareOverlay&&(s.css("top",l.top),s.css("left",l.left)),i.css("visibility","visible"),d.squareOverlay&&r.css("visibility","visible")})),t.on("mouseleave",(function(){i.css("visibility","hidden"),d.squareOverlay&&r.css("visibility","hidden")})),t.is(":hover")&&t.trigger("mouseenter");var e=o.width(),p=o.height(),c=e/a,v=p/n,m=0-(e-i.width()),f=0-(p-i.height());if(d.squareOverlay){var g=a/e*a,u=n/p*n;r.css("height",u),r.css("width",g)}t.on("mousemove",(function(e){l=t.offset();var i=n/2-(e.pageY-l.top)*v;i=Math.max(i,f),i=Math.min(i,0);var s=a/2-(e.pageX-l.left)*c;if(s=Math.max(s,m),s=Math.min(s,0),o.css("top",i),o.css("left",s),d.squareOverlay){var h=e.pageY-l.top-r.height()/2;h=Math.max(h,0),h=Math.min(h,n-r.height());var p=e.pageX-l.left-r.width()/2;p=Math.max(p,0),p=Math.min(p,a-r.width()),r.css("top",h),r.css("left",p)}}))}))}(i,o,d,s,l,a,r,n,t),i.on("extmdestroy",(function(){o.remove(),t.squareOverlay&&s.remove()})),i.on("updateImage",(function(e,t){d.attr("src",t)}))}o.lazy?e(this).width()>10&&e(this).height()>10?e(this).one("mouseenter",(function(){s(o,e(this))})):e(this).one("load",(function(){e(this).one("mouseenter",(function(){s(o,e(this))}))})):e(this).width()>10&&e(this).height()>10?s(o,e(this)):e(this).one("load",(function(){s(o,e(this))}))},extmDestroy:function(){e(this).trigger("extmdestroy")},extmImageUpdate:function(t){e(this).trigger("updateImage",t)}})}(jQuery);
